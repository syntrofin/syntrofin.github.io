<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syntrofin Demo Login</title>
    <!-- Use relative paths for Vercel deployment efficiency -->
    <link rel="stylesheet" href="./syntrofin_files/cssjs/login.css">
</head>
<body>
    <h1>Syntrofin Login (Soft Check)</h1>

    <div class="login-container">
        <input id="user" placeholder="User ID" autocomplete="username">
        <input id="pass" type="password" placeholder="Password" autocomplete="current-password">
        <button id="login-btn">Login</button>
    </div>

    <script>
      // 2026 Best Practice: Use async/await with robust error handling
      async function login() {
        const user = document.getElementById('user').value;
        const pass = document.getElementById('pass').value;

        // Visual feedback
        const btn = document.getElementById('login-btn');
        btn.disabled = true;
        btn.innerText = "Checking...";

        try {
          // CALLING THE VERCEL API:
          // Use a relative path so it works in both Development and Production
          const response = await fetch('https://auth-phi-seven.vercel.app/auth.js', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ userId: user, password: pass })
          });

          if (!response.ok) throw new Error('Network response was not ok');

          const result = await response.json();

          // Check for the "yes" flag from your Vercel Function
          if (result.auth === "yes") {
            console.log("Success! Welcome.");
            alert("Success! Welcome.");
            // Example: window.location.href = "/dashboard";
          } else {
            console.warn("Access Denied.");
            alert("Access Denied: Invalid Credentials.");
          }
        } catch (error) {
          console.error("API Call Failed:", error);
          alert("Connection Error. Please try again later.");
        } finally {
          btn.disabled = false;
          btn.innerText = "Login";
        }
      }

      // Modern event listener separation
      document.getElementById('login-btn').addEventListener('click', login);
    </script>
</body>
</html>
